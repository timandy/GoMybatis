### 事务处理包

#### 引用onlyasd 的描述

Spring的做法就是把事务和方法调用路径存在栈里放入线程变量。 拿Web项目举例，假设一个请求进来开启一个线程，然后某个方法里请求开启事务时，Spring开启一个事务和当前方法全路径名压入栈放进线程变量，当第二个方法请求开启事务时，Sping先从线程变量中获取事务，判断是否已经有开启的事务以及当前方法的事务类型，如果也是使用默认事务类型，就直接把线程变量中的事务交给当前方法使用，并且把第二个方法全路径名也压入栈，如果还有第三个第四个方法同上。当最最后数据库操作执行结束开始返回之后，非开启事务的第一个方法调用Commit或者RollBack都是无效的，每返回到上一层从栈中移除一个方法，栈中元素大于1，Commit或者RollBack被调用都直接无视，直到最后返回到开启事务的方法调用Commit或者RollBack事务完成。 这样的话，当如上描述中第二第三第四任意方法被独立调用，都不用操心，第二第三第四任意方法里都可以放心的Commit或者RollBack。